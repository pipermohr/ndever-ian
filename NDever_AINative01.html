<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ndever Coach: AI-Native Growth Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
        }
        .card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            padding: 24px;
        }
        .progress-bar {
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background-color: #3b82f6; /* Tailwind blue-500 */
            border-radius: 4px;
            transition: width 0.3s ease-in-out;
        }
        .chat-window {
            height: 500px; /* Fixed height for demo */
            display: flex;
            flex-direction: column;
            border-radius: 12px;
            overflow: hidden;
            background-color: #f8fafc; /* Light blue-gray for chat background */
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }
        .chat-body {
            flex-grow: 1;
            padding: 16px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .chat-input-area {
            padding: 16px;
            border-top: 1px solid #e2e8f0; /* Light gray border */
            display: flex;
            gap: 12px;
            background-color: white;
        }
        .chat-message {
            max-width: 85%;
            padding: 10px 16px;
            border-radius: 18px;
            font-size: 0.95rem;
            line-height: 1.4;
        }
        .chat-message.user {
            background-color: #dbeafe; /* blue-100 */
            align-self: flex-end;
            color: #1e40af; /* blue-800 */
        }
        .chat-message.ai {
            background-color: #ecfdf5; /* green-50 */
            align-self: flex-start;
            color: #065f46; /* green-800 */
            position: relative;
        }
        .ai-icon {
            position: absolute;
            left: -32px;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            background-color: #10b981; /* green-500 */
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.75rem;
            font-weight: bold;
        }
        .ai-message-bubble {
            background-color: #ecfdf5; /* green-50 */
            padding: 10px 16px;
            border-radius: 18px;
            position: relative;
            margin-left: 40px; /* Space for icon */
        }
        .ai-message-bubble::before {
            content: '';
            position: absolute;
            left: -10px;
            top: 15px;
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-right: 10px solid #ecfdf5;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white shadow-sm p-4 flex justify-between items-center">
        <div class="text-2xl font-bold text-gray-800">Ndever Coach</div>
        <nav class="space-x-4">
            <span class="text-gray-600 font-medium">Welcome, John Doe (Real Estate Agent)</span>
            <button class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors">Logout</button>
        </nav>
    </header>

    <!-- Main Content Area -->
    <main class="flex-grow p-6 grid grid-cols-1 lg:grid-cols-3 gap-6">

        <!-- Left Column: Objective & Playbook -->
        <div class="lg:col-span-2 space-y-6">

            <!-- My Active Objective Card (The new 'Objective' object) -->
            <div class="card">
                <h1 class="text-2xl font-bold text-gray-800 mb-4">My Active Objective: Achieve $250K GCI in 2024</h1>
                <p class="text-gray-600 mb-6">Your primary financial goal for the year, broken down into key performance indicators. **(Data auto-synced via IPaaS)**</p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div>
                        <p class="text-sm text-gray-500">Target GCI</p>
                        <p class="text-xl font-semibold text-blue-600">$250,000</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">YTD GCI (from QuickBooks)</p>
                        <p class="text-xl font-semibold text-green-600" id="ytdGci">$85,000</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">GCI Progress</p>
                        <div class="progress-bar mt-1">
                            <div class="progress-fill" id="gciProgressBar" style="width: 34%;"></div>
                        </div>
                        <p class="text-sm text-gray-500 mt-1"><span id="gciPercentage">34</span>% of target</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <p class="text-sm text-gray-500">Required Transactions</p>
                        <p class="text-xl font-semibold text-gray-700">10</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">YTD Transactions (from CRM)</p>
                        <p class="text-xl font-semibold text-green-600" id="ytdTransactions">3</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">Lead-to-Close Rate (from CRM)</p>
                        <p class="text-xl font-semibold text-purple-600" id="conversionRate">3.5%</p>
                    </div>
                </div>
            </div>

            <!-- Active Playbook Journey Card -->
            <div class="card">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Active Playbook: Lead Generation & Prospecting Mastery</h2>
                <p class="text-gray-600 mb-6">Your current focus to build a robust pipeline of potential clients.</p>

                <!-- Milestone: Generate 10 Qualified Buyer Leads This Week -->
                <div class="bg-gray-50 p-4 rounded-lg shadow-sm mb-4">
                    <h3 class="text-xl font-medium text-gray-700 mb-3">Milestone: Generate 10 Qualified Buyer Leads This Week</h3>
                    <div class="progress-bar mb-3">
                        <div id="leadsMilestoneProgress" class="progress-fill" style="width: 0%;"></div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="task1" class="form-checkbox h-5 w-5 text-blue-600 rounded-md">
                            <label for="task1" class="text-gray-700 flex-grow">Make 20 Cold Calls</label>
                            <input type="number" id="callsMade" placeholder="Calls Made" class="w-28 p-2 border border-gray-300 rounded-md text-sm" min="0" value="0">
                        </div>
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="task2" class="form-checkbox h-5 w-5 text-blue-600 rounded-md">
                            <label for="task2" class="text-gray-700 flex-grow">Send 15 Personalized LinkedIn Messages</label>
                            <input type="number" id="linkedinMessages" placeholder="Messages Sent" class="w-28 p-2 border border-gray-300 rounded-md text-sm" min="0" value="0">
                        </div>
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="task3" class="form-checkbox h-5 w-5 text-blue-600 rounded-md">
                            <label for="task3" class="text-gray-700 flex-grow">Host 2 Open Houses</label>
                            <input type="number" id="openHouses" placeholder="Open Houses" class="w-28 p-2 border border-gray-300 rounded-md text-sm" min="0" value="0">
                        </div>
                    </div>
                    <p class="text-xs text-gray-500 mt-3">*(IPaaS: Calls/Messages auto-logged from CRM. Open Houses manually input.)*</p>
                </div>

                <!-- AI Nudge Example within Playbook -->
                <div class="bg-blue-50 p-4 rounded-lg shadow-sm mb-4 border border-blue-200">
                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-sm">AI</div>
                        <div class="flex-grow">
                            <p class="font-semibold text-blue-800 mb-1">Ndever Coach AI Suggestion:</p>
                            <p class="text-sm text-blue-700">"John, your LinkedIn message engagement is lower than expected for your target market. Consider reviewing the 'Crafting Compelling Outreach' recipe in your 'Marketing Fundamentals' Journey. I've added it to your queue."</p>
                            <button class="text-blue-600 text-sm mt-2 hover:underline">View Recipe</button>
                        </div>
                    </div>
                </div>

                <!-- Milestone: Secure 3 Listing Appointments This Month -->
                <div class="bg-gray-50 p-4 rounded-lg shadow-sm mb-4">
                    <h3 class="text-xl font-medium text-gray-700 mb-3">Milestone: Secure 3 Listing Appointments This Month</h3>
                    <div class="progress-bar mb-3">
                        <div id="listingsMilestoneProgress" class="progress-fill" style="width: 0%;"></div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="task4" class="form-checkbox h-5 w-5 text-blue-600 rounded-md">
                            <label for="task4" class="text-gray-700 flex-grow">Follow up with 10 Past Clients</label>
                            <input type="number" id="pastClientsFollowup" placeholder="Follow-ups" class="w-28 p-2 border border-gray-300 rounded-md text-sm" min="0" value="0">
                        </div>
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="task5" class="form-checkbox h-5 w-5 text-blue-600 rounded-md">
                            <label for="task5" class="text-gray-700 flex-grow">Attend 1 Local Networking Event</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Column: Ndever Coach AI Chat -->
        <div class="lg:col-span-1">
            <div class="chat-window card">
                <div class="text-xl font-bold text-gray-800 p-4 border-b border-gray-200">Ndever Coach AI</div>
                <div id="chatBody" class="chat-body">
                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-sm">AI</div>
                        <div class="ai-message-bubble">
                            <p>Good morning, John! I see your YTD GCI is at $85,000. That's 34% towards your $250,000 objective. You've closed 3 transactions so far. How are you feeling about your progress on lead generation this week?</p>
                        </div>
                    </div>
                    <div class="flex items-start justify-end gap-3">
                        <div class="chat-message user">I'm a bit stuck on getting new leads. My cold calls aren't converting well.</div>
                    </div>
                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-sm">AI</div>
                        <div class="ai-message-bubble">
                            <p>I understand. Your CRM data shows your call volume is on target, but the conversion rate for cold calls is below average for agents in your market. Let's focus on improving your script. Would you like me to pull up the 'Mastering Cold Call Openers' recipe from your Playbook?</p>
                        </div>
                    </div>
                    <div class="flex items-start justify-end gap-3">
                        <div class="chat-message user">Yes, please! And any tips on handling objections?</div>
                    </div>
                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-sm">AI</div>
                        <div class="ai-message-bubble">
                            <p>Excellent! I've added 'Mastering Cold Call Openers' to your current Milestone. For objections, I recommend the 'Common Objections & Responses' recipe. I can also initiate a quick role-play simulation with you right here. Shall we try that?</p>
                        </div>
                    </div>
                </div>
                <div class="chat-input-area">
                    <input type="text" id="chatInput" placeholder="Ask Ndever Coach..." class="flex-grow p-3 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    <button id="sendChatBtn" class="bg-blue-500 text-white px-5 py-3 rounded-md hover:bg-blue-600 transition-colors">Send</button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // --- Data & Progress Simulation ---
        const objectiveData = {
            targetGci: 250000,
            ytdGci: 85000,
            ytdTransactions: 3,
            conversionRate: 3.5 // %
        };

        const tasks = [
            { id: 'task1', milestoneId: 'leadsMilestoneProgress', valueInputId: 'callsMade', currentVal: 0, targetVal: 20 },
            { id: 'task2', milestoneId: 'leadsMilestoneProgress', valueInputId: 'linkedinMessages', currentVal: 0, targetVal: 15 },
            { id: 'task3', milestoneId: 'leadsMilestoneProgress', valueInputId: 'openHouses', currentVal: 0, targetVal: 2 },
            { id: 'task4', milestoneId: 'listingsMilestoneProgress', valueInputId: 'pastClientsFollowup', currentVal: 0, targetVal: 10 },
            { id: 'task5', milestoneId: 'listingsMilestoneProgress', currentVal: 0, targetVal: 1 } // Attend networking event
        ];

        const milestones = {
            'leadsMilestoneProgress': { taskIds: ['task1', 'task2', 'task3'] },
            'listingsMilestoneProgress': { taskIds: ['task4', 'task5'] }
        };

        function updateObjectiveDisplay() {
            const gciPercentage = (objectiveData.ytdGci / objectiveData.targetGci) * 100;
            document.getElementById('ytdGci').textContent = `$${objectiveData.ytdGci.toLocaleString()}`;
            document.getElementById('gciProgressBar').style.width = `${Math.min(gciPercentage, 100)}%`;
            document.getElementById('gciPercentage').textContent = gciPercentage.toFixed(0);
            document.getElementById('ytdTransactions').textContent = objectiveData.ytdTransactions;
            document.getElementById('conversionRate').textContent = `${objectiveData.conversionRate}%`;
        }

        function updateMilestoneProgress() {
            for (const milestoneId in milestones) {
                const milestone = milestones[milestoneId];
                let completedTasks = 0;
                let totalTasks = milestone.taskIds.length;

                milestone.taskIds.forEach(taskId => {
                    const taskElement = document.getElementById(taskId);
                    if (taskElement && taskElement.checked) {
                        completedTasks++;
                    }
                });
                const progress = (completedTasks / totalTasks) * 100;
                document.getElementById(milestoneId).style.width = `${progress}%`;
            }
        }

        // --- Event Listeners for Task Inputs ---
        tasks.forEach(task => {
            const checkbox = document.getElementById(task.id);
            if (checkbox) {
                checkbox.addEventListener('change', updateMilestoneProgress);
            }
            if (task.valueInputId) {
                const input = document.getElementById(task.valueInputId);
                if (input) {
                    input.addEventListener('input', (e) => {
                        task.currentVal = parseInt(e.target.value) || 0;
                        // In a real app, this input would trigger IPaaS sync and objective updates.
                        // For this demo, we just update the input's value.
                    });
                }
            }
        });

        // Initial render
        updateObjectiveDisplay();
        updateMilestoneProgress();

        // --- AI Chat Simulation Logic ---
        const chatBody = document.getElementById('chatBody');
        const chatInput = document.getElementById('chatInput');
        const sendChatBtn = document.getElementById('sendChatBtn');

        function addMessage(sender, text) {
            const messageWrapper = document.createElement('div');
            messageWrapper.className = `flex items-start gap-3 ${sender === 'user' ? 'justify-end' : ''}`;

            if (sender === 'ai') {
                const aiIcon = document.createElement('div');
                aiIcon.className = 'flex-shrink-0 w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-sm';
                aiIcon.textContent = 'AI';
                messageWrapper.appendChild(aiIcon);

                const aiBubble = document.createElement('div');
                aiBubble.className = 'ai-message-bubble';
                aiBubble.innerHTML = `<p>${text}</p>`;
                messageWrapper.appendChild(aiBubble);
            } else {
                const userMessageDiv = document.createElement('div');
                userMessageDiv.className = 'chat-message user';
                userMessageDiv.textContent = text;
                messageWrapper.appendChild(userMessageDiv);
            }
            chatBody.appendChild(messageWrapper);
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        sendChatBtn.addEventListener('click', () => {
            const message = chatInput.value.trim();
            if (message) {
                addMessage('user', message);
                chatInput.value = '';

                // Simulate AI response (Concierge MVP: human-driven, but designed to look AI-native)
                setTimeout(() => {
                    let aiResponse = "Thanks for your message! Your Ndever Coach is reviewing your data and will provide a tailored response shortly.";
                    if (message.toLowerCase().includes("leads")) {
                        aiResponse = "I understand your concern about leads. Based on your current objective and CRM data, we need to boost your qualified lead count. Let's explore some strategies. Would you like to review the 'Optimizing Social Media Prospecting' recipe?";
                    } else if (message.toLowerCase().includes("objections")) {
                        aiResponse = "Handling objections is key! I can pull up the 'Common Objections & Responses' recipe for you. Would you like to practice some role-play scenarios?";
                    } else if (message.toLowerCase().includes("gci")) {
                        aiResponse = `Your current GCI is $${objectiveData.ytdGci.toLocaleString()}. To hit your $${objectiveData.targetGci.toLocaleString()} target, we need to accelerate your transaction volume. I can help you identify high-potential leads in your pipeline.`;
                    }
                    addMessage('ai', aiResponse);
                }, 1500); // Simulate network delay
            }
        });

        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendChatBtn.click();
            }
        });
    </script>
</body>
</html>
